a
    ЛЈлЊ!]vJ  л│                   @   sлъ   d dl mZmZmZmZmZ d dlmZmZm	Z	m
Z
 d dlmZm
Z
mZ d dlmZ d dlmZ d dlZd dlZd dlZd dlmZ d dlmZ d d	lmZ d d
lmZ d dlT e┬аdлјZ G d
dРђъ deЛЊZ!dS )л╣    )лфQMainWindowлфqAppлфQMessageBoxлфQApplicationлф	QListView)лфQStandardItemModelлф
QStandardItemлфQBrushлфQColor)лфpyqtSlotлфQEventлфQt)лф
PKCS1_OAEP)лфRSAN)лфUi_MainClientWindow)лфAddContactDialog)лфDelContactDialog)лфServerError)лф*лфclientc                       s┬г   e Zd ZdZРђА fddРђъZddРђъ ZddРђъ Zdd	Рђъ Zd
dРђъ Zdd
Рђъ Z	ddРђъ Z
ddРђъ ZddРђъ ZddРђъ Z
ddРђъ ZddРђъ ZeeЛЊddРђъ ЛЊZeЛЊ ddРђъ ЛЊZeЛЊ ddРђъ ЛЊZd d!Рђъ ZРђА  ZS )"лфClientMainWindowu\
    лаЛЎла┬╗ла┬░лАлЃлАлЃ - лаЛЋлАлЃлалЁлаЛЋлалєлалЁлаЛЋла┬х лаЛЋлаЛћлалЁлаЛЋ лаЛЌлаЛЋла┬╗лАліла┬илаЛЋлалєла┬░лАРђџла┬хла┬╗лАлЈ.
    лалјлаЛЋламЉла┬хлАлѓла┬ХлаЛЉлАРђџ лалєлАлЃлАлІ лаЛЋлАлЃлалЁлаЛЋлалєлалЁлАЛЊлАлІ ла┬╗лаЛЋлаЛќлаЛЉлаЛћлАЛЊ лАлѓла┬░ла┬▒лаЛЋлАРђџлАРђ╣ лаЛћла┬╗лаЛЉла┬хлалЁлАРђџлАлЃлаЛћлаЛЋлаЛќлаЛЋ лаЛўлаЛЋламЉлАЛЊла┬╗лАлЈ.
    лаЛЎлаЛЋлалЁлАРђълаЛЉлаЛќлАЛЊлАлѓла┬░лАРђалаЛЉлАлЈ лаЛЋлаЛћлалЁла┬░ лАлЃлаЛЋла┬иламЉла┬░лалЁла┬░ лалє QTDesigner лаЛЉ ла┬ила┬░лаЛќлАлѓлАЛЊла┬Хла┬░ла┬хлАРђџлАлЃлАлЈ лаЛЉла┬и
    лаЛћлаЛЋлалЁлалєла┬хлАлѓлАРђџлаЛЉлАлѓлаЛЋлалєла┬░лалЁлаЛЋлаЛќлаЛЋ лАРђъла┬░лаРёќла┬╗ла┬░ main_window_conv.py
    c                    s  t ЛЊ ┬алј  || _|| _t┬а|лј| _tЛЊ | _| j┬а	| лј | jj
j┬аt
jлј | jjj┬а| jлј | jjj┬а| jлј | jjj┬а| jлј | jjj┬а| jлј | jjj┬а| jлј d | _d | _tЛЊ | _d | _d | _d | _| jj┬а t!j"лј | jj┬а#dлј | jj$j%┬а| j&лј | ┬а'лј  | ┬а(лј  | ┬а)лј  d S )NT)*лфsuperлф__init__лфdatabaseлф	transportr   лфnewлф	decrypterr   лфuiZsetupUiZ	menu_exitZ	triggeredлфconnectr   лфexitлфbtn_sendлфclickedлфsend_messageZbtn_add_contactлфadd_contact_windowZmenu_add_contactZbtn_remove_contactлфdelete_contact_windowZmenu_del_contactлфcontacts_modelлф
history_modelr   лфmessagesлфcurrent_chatлфcurrent_chat_keyлф	encryptorлф
list_messagesZsetHorizontalScrollBarPolicyr
   ZScrollBarAlwaysOffZsetWordWrapлф
list_contactsZ
doubleClickedлфselect_active_userлфclients_list_updateлфset_disabled_inputлфshow)лфselfr   r   лфkeys┬Елф	__class__┬Е ЛіW/home/su/Projects/GeekBrains/data-base-and-PyQt/lesson_7/practice/client/main_window.pyr      s4    
ЛЈzClientMainWindow.__init__c                 C   sj   | j j┬аdлј | j j┬алј  | jr*| j┬алј  | j j┬аdлј | j j┬аdлј | j j┬аdлј d| _	d| _
d| _dS )uG    лаЛџла┬хлАРђџлаЛЋламЉ ламЉла┬хла┬╗ла┬░лАлІлАРђ░лаЛЉлаРёќ лаЛЌлаЛЋла┬╗лАлЈ лалєлалєлаЛЋламЉла┬░ лалЁла┬хла┬░лаЛћлАРђџлаЛЉлалєлалЁлАРђ╣лаЛўлаЛЉur   лаРђЮла┬╗лАлЈ лалєлАРђ╣ла┬▒лаЛЋлАлѓла┬░ лаЛЌлаЛЋла┬╗лАЛЊлАРђАла┬░лАРђџла┬хла┬╗лАлЈ ламЉлалєла┬░ла┬ХламЉлАРђ╣ лаЛћла┬╗лаЛЉлаЛћлалЁлаЛЉлАРђџла┬х лалЁла┬░ лалЁла┬хлаЛў лалє лаЛЋлаЛћлалЁла┬х лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџлаЛЋлалє.TN)r   лфlabel_new_messageлфsetTextлфtext_messageлфclearr&   лф	btn_clearлфsetDisabledr    r*   r(   r)   ┬Еr1   r5   r5   r6   r/   H   s    ЛЈ
z#ClientMainWindow.set_disabled_inputc                 C   sL  t | j┬а| jлјddРђъ dлї}| js8tЛЊ | _| jj┬а| jлј | j┬а	лј  t
|ЛЊ}d}|dkr^|d }t||ЛЊD ]лб}|| }|d dkrл«td|d	 j
dd
лїРђ║ d|d Рђ║ ЛюЛЊ}|┬аd
лј |┬аttdddЛЊЛЊлј |┬аtjлј | j┬а|лј qhtd|d	 j
dd
лїРђ║ d|d Рђ║ ЛюЛЊ}|┬аd
лј |┬аtjлј |┬аttdddЛЊЛЊлј | j┬а|лј qh| jj┬алј  dS )uмЉ
        лаЛџла┬хлАРђџлаЛЋламЉ ла┬ила┬░лаЛЌлаЛЋла┬╗лалЁлАлЈлАлІлАРђ░лаЛЉлаРёќ лАлЃлаЛЋлаЛЋлАРђџлалєла┬хлАРђџлАлЃлАРђџлалєлАЛЊлАлІлАРђ░лаЛЉлаРёќ QListView
        лаЛЉлАлЃлАРђџлаЛЋлАлѓлаЛЉла┬хлаРёќ лаЛЌла┬хлАлѓла┬хлаЛЌлаЛЉлАлЃлаЛћлаЛЉ лАлЃ лАРђџла┬хлаЛћлАЛЊлАРђ░лаЛЉлаЛў лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћлаЛЋлаЛў.
        c                 S   s   | d S )Nл╣   r5   )лфitemr5   r5   r6   лф<lambda>c   ЛЃ    z6ClientMainWindow.history_list_update.<locals>.<lambda>)лфkeyr   л╣   л╣   лфinu   лаРђЎлАРђдлаЛЋламЉлАлЈлАРђ░ла┬хла┬х лаЛЋлАРђџ r>   )лфmicrosecondz:
 л╣   Fл╣ЛЈ   л╣лЦ   u   ла┬ўлАлЃлАРђдлаЛЋламЉлАлЈлАРђ░ла┬хла┬х лаЛЋлАРђџ л╣лю   N)лфsortedr   лфget_historyr(   r&   r   r   r+   лфsetModelr:   лфlenлфranger   лфreplaceлфsetEditableZ
setBackgroundr	   r
   ZsetTextAlignmentr
   Z	AlignLeftлф	appendRowZ
AlignRightZscrollToBottom)r1   лфlistлфlengthлфstart_indexлфir?   Zmessr5   r5   r6   лфhistory_list_updateZ   s@    ЛЈЛЇ
ЛЈ
ЛЈ
z$ClientMainWindow.history_list_updatec                 C   s   | j j┬алј ┬алј | _| ┬алј  dS )up   лаЛџла┬хлАРђџлаЛЋламЉ лаЛЋла┬▒лАлѓла┬░ла┬▒лаЛЋлАРђџлАРђАлаЛЉлаЛћ лАлЃлаЛЋла┬▒лАРђ╣лАРђџлаЛЉлАлЈ ламЉлалєлаЛЋлаРёќлалЁлаЛЋлаЛќлаЛЋ лаЛћла┬╗лаЛЉлаЛћла┬░ лаЛЌлаЛЋ лАлЃлаЛЌлаЛЉлАлЃлаЛћлАЛЊ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџлаЛЋлалє.N)r   r,   ZcurrentIndexлфdatar(   лфset_active_userr=   r5   r5   r6   r-   Рђъ   s    z#ClientMainWindow.select_active_userc              	   C   sл░   z@| j ┬а| jлј| _t┬аd| jРђ║ Люлј | jr>t┬аt┬а	| jлјлј| _
W n6 ttj
fyv   d| _d| _
t┬аd| jРђ║ Люлј Y n0 | jsРђЎ| j┬а| ddлј dS | jj┬аd| jРђ║ dЛюлј | jj┬аdлј | jj┬аdлј | jj┬аdлј | ┬алј  dS )	uC   лаЛџла┬хлАРђџлаЛЋламЉ ла┬░лаЛћлАРђџлаЛЉлалєла┬░лАРђалаЛЉлаЛЉ лАРђАла┬░лАРђџла┬░ лАлЃ лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћлаЛЋлаЛў.u2   лаРђћла┬░лаЛќлАлѓлАЛЊла┬Хла┬хлалЁ лаЛЋлАРђџлаЛћлАлѓлАРђ╣лАРђџлАРђ╣лаРёќ лаЛћла┬╗лАлІлАРђА ламЉла┬╗лАлЈ Nu5   лаЛюла┬х лАЛЊламЉла┬░ла┬╗лаЛЋлАлЃлАлі лаЛЌлаЛЋла┬╗лАЛЊлАРђАлаЛЉлАРђџлАлі лаЛћла┬╗лАлІлАРђА ламЉла┬╗лАлЈ ЛЁ   лаЛЏлАРѓглаЛЉла┬▒лаЛћла┬░u\   лаРђЮла┬╗лАлЈ лалєлАРђ╣ла┬▒лАлѓла┬░лалЁлалЁлаЛЋлаЛќлаЛЋ лаЛЌлаЛЋла┬╗лАліла┬илаЛЋлалєла┬░лАРђџла┬хла┬╗лАлЈ лалЁла┬хлАРђџ лаЛћла┬╗лАлІлАРђАла┬░ лАРѓглаЛЉлАРђълАлѓлаЛЋлалєла┬░лалЁлаЛЉлАлЈ.u+   лаРђЎлалєла┬хламЉлаЛЉлАРђџла┬х лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлалЁлаЛЉла┬х ламЉла┬╗лАлЈ Лі:F)r   лфkey_requestr(   r)   лфloggerлфdebugr   r   r   лф
import_keyr*   лфOSErrorлфjsonлфJSONDecodeErrorr'   лфwarningr   r7   r8   r;   r<   r    r9   rW   r=   r5   r5   r6   rY   лі   s2    ЛЈ
ЛЈ
ЛЈЛЈz ClientMainWindow.set_active_userc                 C   sR   | j ┬алј }tЛЊ | _t|ЛЊD ]"}t|ЛЊ}|┬аdлј | j┬а|лј q| jj	┬а
| jлј dS )uB   лаЛџла┬хлАРђџлаЛЋламЉ лаЛЋла┬▒лалЁлаЛЋлалєла┬╗лАлЈлАлІлАРђ░лаЛЉлаРёќ лАлЃлаЛЌлаЛЉлАлЃлаЛЋлаЛћ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџлаЛЋлалє.FN)r   лфget_contactsr   r%   rK   r   rQ   rR   r   r,   rM   )r1   Z
contacts_listrV   r?   r5   r5   r6   r.   ┬Ф   s    

z$ClientMainWindow.clients_list_updatec                    s0   t Рѓг jРѓг jЛЊatjj┬аРђА fddРђълј t┬алј  dS )u[   лаЛџла┬хлАРђџлаЛЋламЉ лАлЃлаЛЋла┬иламЉла┬░лАлІлАРђ░лаЛЉлаРёќ лаЛЋлаЛћлалЁлаЛЋ - ламЉлаЛЉла┬░ла┬╗лаЛЋлаЛќ ламЉлаЛЋла┬▒ла┬░лалєла┬╗ла┬хлалЁлаЛЉлАлЈ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџла┬░c                      s
   Рѓг ┬а tлјS ┬ЕN)лфadd_contact_actionлф
select_dialogr5   r=   r5   r6   r@   Лћ   rA   z5ClientMainWindow.add_contact_window.<locals>.<lambda>N)r   r   r   rg   лфbtn_okr!   r   r0   r=   r5   r=   r6   r#   ┬х   s
    
ЛЈz#ClientMainWindow.add_contact_windowc                 C   s    |j ┬алј }| ┬а|лј |┬алј  dS )uL   лаЛџла┬хлАРђџлаЛЋламЉ лаЛЋла┬▒лАлѓла┬░ла┬▒лаЛЋлАРђџлАРђАлаЛћ лалЁла┬░ла┬Хла┬░лАРђџлаЛЉлАлЈ лаЛћлалЁлаЛЋлаЛЌлаЛћлаЛЉ "лаРђЮлаЛЋла┬▒ла┬░лалєлаЛЉлАРђџлАлі"N)лфselectorлфcurrentTextлфadd_contactлфclose)r1   r?   лфnew_contactr5   r5   r6   rf   лЁ   s    

z#ClientMainWindow.add_contact_actionc           
   C   sлХ   z| j ┬а|лј W nРђа tyF } z| j┬а| d|jлј W Y d}~n┬цd}~0  tyРђЊ } z:|jrr| j┬а| ddлј | ┬алј  | j┬а| ddлј W Y d}~nTd}~0 0 | j	┬а|лј t
|ЛЊ}|┬аdлј | j┬а
|лј t┬аd|Рђ║ Люлј | j┬а| dd	лј dS )
uли
        лаЛџла┬хлАРђџлаЛЋламЉ ламЉлаЛЋла┬▒ла┬░лалєла┬╗лАлЈлАлІлАРђ░лаЛЉлаРёќ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ лалє лАлЃла┬хлАлѓлалєла┬хлАлѓлалЁлАЛЊлАлІ лаЛЉ лаЛћла┬╗лаЛЉла┬хлалЁлАРђџлАлЃлАРђџлаЛћлАЛЊлАлІ BD.
        лаЛЪлаЛЋлАлЃла┬╗ла┬х лаЛЋла┬▒лалЁлаЛЋлалєла┬╗ла┬хлалЁлаЛЉлАлЈ ла┬▒ла┬░ла┬и ламЉла┬░лалЁлалЁлАРђ╣лАРђд лаЛЋла┬▒лалЁлаЛЋлалєла┬╗лАлЈла┬хлАРђџ лаЛЉ лАлЃлаЛЋламЉла┬хлАлѓла┬ХлаЛЉлаЛўлаЛЋла┬х лаЛЋлаЛћлалЁла┬░.
        ЛЁ   лаЛЏлАРѓглаЛЉла┬▒лаЛћла┬░ лАлЃла┬хлАлѓлалєла┬хлАлѓла┬░NrZ   ЛЁ:   лаЛЪлаЛЋлАРђџла┬хлАлѓлАлЈлалЁлаЛЋ лАлЃлаЛЋла┬хламЉлаЛЉлалЁла┬хлалЁлаЛЉла┬х лАлЃ лАлЃла┬хлАлѓлалєла┬хлАлѓлаЛЋлаЛў!ЛЁ$   лаЛъла┬░лаРёќлаЛўла┬░лАЛЊлАРђџ лАлЃлаЛЋла┬хламЉлаЛЉлалЁла┬хлалЁлаЛЉлАлЈ!Fu/   лалѕлАлЃлаЛЌла┬хлАРѓглалЁлаЛЋ ламЉлаЛЋла┬▒ла┬░лалєла┬╗ла┬хлалЁ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ ЛЁ
   лалѕлАлЃлаЛЌла┬хлАРђдu/   лаЛЎлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ лАЛЊлАлЃлаЛЌла┬хлАРѓглалЁлаЛЋ ламЉлаЛЋла┬▒ла┬░лалєла┬╗ла┬хлалЁ.)r   rk   r   r'   лфcriticalлфtextr`   лфerrnorl   r   r   rQ   r%   rR   r]   лфinfoлфinformation)r1   rm   лфerrr5   r5   r6   rk   лЊ   s&    &ЛЈ&
ЛЈzClientMainWindow.add_contactc                    s,   t Рѓг jЛЊatjj┬аРђА fddРђълј t┬алј  dS )uI   лаЛџла┬хлАРђџлаЛЋламЉ лАлЃлаЛЋла┬иламЉла┬░лАлІлАРђ░лаЛЉлаРёќ лаЛЋлаЛћлалЁлаЛЋ лАЛЊламЉла┬░ла┬╗ла┬хлалЁлаЛЉлАлЈ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџла┬░.c                      s
   Рѓг ┬а tлјS re   )лфdelete_contactлф
remove_dialogr5   r=   r5   r6   r@   л░   rA   z8ClientMainWindow.delete_contact_window.<locals>.<lambda>N)r   r   ry   rh   r!   r   r0   r=   r5   r=   r6   r$   лФ   s
    

ЛЈz&ClientMainWindow.delete_contact_windowc           
   C   sЛі   |j ┬алј }z| j┬а|лј W nРђа tyP } z| j┬а| d|jлј W Y d}~n┬«d}~0  ty┬а } z:|j	r|| j┬а| ddлј | ┬а
лј  | j┬а| ddлј W Y d}~n^d}~0 0 | j┬а|лј | ┬а
лј  t┬аd|Рђ║ Люлј | j┬а| ddлј |┬а
лј  || jkrЛєd| _| ┬алј  dS )	uлх
        лаЛџла┬хлАРђџлаЛЋламЉ лАЛЊламЉла┬░ла┬╗лАлЈлАлІлАРђ░лаЛЉлаРёќ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ лаЛЉла┬и лАлЃла┬хлАлѓлалєла┬хлАлѓлалЁлаЛЋлаРёќ лаЛЉ лаЛћла┬╗лаЛЉла┬хлалЁлАРђџлАлЃлАРђџлаЛћлаЛЋлаРёќ BD.
        лаЛЪлаЛЋлАлЃла┬╗ла┬х лаЛЋла┬▒лалЁлаЛЋлалєла┬╗ла┬хлалЁлаЛЉлАлЈ ла┬▒ла┬░ла┬и ламЉла┬░лалЁлалЁлАРђ╣лАРђд лаЛЋла┬▒лалЁлаЛЋлалєла┬╗лАлЈла┬хлАРђџ лаЛЉ лАлЃлаЛЋламЉла┬хлАлѓла┬ХлаЛЉлаЛўлаЛЋла┬х лаЛЋлаЛћлалЁла┬░.
        rn   NrZ   ro   rp   u+   лалѕлАлЃлаЛЌла┬хлАРѓглалЁлаЛЋ лАЛЊламЉла┬░ла┬╗лАРђўлалЁ лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ rq   u+   лаЛЎлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ лАЛЊлАлЃлаЛЌла┬хлАРѓглалЁлаЛЋ лАЛЊламЉла┬░ла┬╗лАРђўлалЁ.)ri   rj   r   лфremove_contactr   r'   rr   rs   r`   rt   rl   r   лфdel_contactr.   r]   ru   rv   r(   r/   )r1   r?   лфselectedrw   r5   r5   r6   rx   л│   s(    
&ЛЈ&
zClientMainWindow.delete_contactc           
   C   sB  | j j┬алј }| j j┬алј  |s dS | j┬а|┬аdлјлј}t┬а|лј}z| j	┬а
| j|┬аdлјлј W nмЉ t
yлі } z| j┬а| d|jлј W Y d}~nЛћd}~0  tyлг } z:|jrЛЉ| j┬а| ddлј | ┬алј  | j┬а| ddлј W Y d}~njd}~0  ttfЛњy
   | j┬а| ddлј | ┬алј  Y n40 | j┬а| jd|лј t┬аd| jРђ║ d	|Рђ║ Люлј | ┬алј  dS )
uлю
        ла┬цлАЛЊлалЁлаЛћлАРђалаЛЉлАлЈ лаЛЋлАРђџлаЛЌлАлѓла┬░лалєлаЛћлаЛЉ лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉлАлЈ лАРђџла┬хлаЛћлАЛЊлАРђ░ла┬хлаЛўлАЛЊ лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћлАЛЊ.
        ла┬ала┬хла┬░ла┬╗лаЛЉла┬илАЛЊла┬хлАРђџ лАРѓглаЛЉлАРђълАлѓлаЛЋлалєла┬░лалЁлаЛЉла┬х лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉлАлЈ лаЛЉ ла┬хлаЛќлаЛЋ лаЛЋлАРђџлаЛЌлАлѓла┬░лалєлаЛћлАЛЊ.
        Nлфutf8лфasciirZ   ro   rp   лфoutu/   лаЛЏлАРђџлаЛЌлАлѓла┬░лалєла┬╗ла┬хлалЁлаЛЋ лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉла┬х ламЉла┬╗лАлЈ z: )r   r9   ZtoPlainTextr:   r*   лфencryptлфencodeлфbase64лф	b64encoder   r"   r(   лфdecoder   r'   rr   rs   r`   rt   rl   лфConnectionResetErrorлфConnectionAbortedErrorr   лфsave_messager]   r^   rW   )r1   Zmessage_textZmessage_text_encryptedZmessage_text_encrypted_base64rw   r5   r5   r6   r"   Лј   sF    ЛЈЛЈЛј&ЛЈ$ЛЈЛЈzClientMainWindow.send_messagec              	   C   s"  t ┬а|t лј}z| j┬а|лј}W n( ttfyF   | j┬а| ddлј Y dS 0 | j	┬а
| jd|┬аdлјлј |t
 }|| jkr|| ┬алј  nЛъ| j	┬а|лјrЛЋ| j┬а| dd|Рђ║ dЛюtjtjлјtjkrЛў|| _| ┬алј  n`td	ЛЊ | j┬а| dd|Рђ║ d
ЛюtjtjлјtjkЛњr| ┬а|лј || _| j	┬а
| jd|┬аdлјлј | ┬алј  dS )uлф
        лалјла┬╗лаЛЋлАРђџ лаЛЋла┬▒лАлѓла┬░ла┬▒лаЛЋлАРђџлАРђАлаЛЉлаЛћ лаЛЌлаЛЋлАлЃлАРђџлАЛЊлаЛЌла┬░ла┬хлаЛўлАРђ╣лАРђд лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉлаРёќ, лалєлАРђ╣лаЛЌлаЛЋла┬╗лалЁлАлЈла┬хлАРђџ ламЉла┬хлАРѓглаЛЉлАРђълАлѓлаЛЋлалєлаЛћлАЛЊ
        лаЛЌлаЛЋлАлЃлАРђџлАЛЊлаЛЌла┬░ла┬хлаЛўлАРђ╣лАРђд лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉлаРёќ лаЛЉ лаЛЉлАРђд лАлЃлаЛЋлАРђдлАлѓла┬░лалЁла┬хлалЁлаЛЉла┬х лалє лаЛЉлАлЃлАРђџлаЛЋлАлѓлаЛЉлаЛЉ лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉлаРёќ.
        лаРђћла┬░лаЛЌлАлѓла┬░лАРѓглаЛЉлалєла┬░ла┬хлАРђџ лаЛЌлаЛЋла┬╗лАліла┬илаЛЋлалєла┬░лАРђџла┬хла┬╗лАлЈ ла┬хлАлЃла┬╗лаЛЉ лаЛЌлАлѓлаЛЉлАРѓгла┬╗лаЛЋ лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉла┬х лалЁла┬х лаЛЋлАРђџ лАРђџла┬хлаЛћлАЛЊлАРђ░ла┬хлаЛќлаЛЋ
        лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћла┬░. лаЛЪлАлѓлаЛЉ лалЁла┬хлаЛЋла┬▒лАРђдлаЛЋламЉлаЛЉлаЛўлаЛЋлАлЃлАРђџлаЛЉ лаЛўла┬хлалЁлАлЈла┬хлАРђџ лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћла┬░.
        rZ   u@   лаЛюла┬х лАЛЊламЉла┬░ла┬╗лаЛЋлАлЃлАлі ламЉла┬хлаЛћлаЛЋламЉлаЛЉлАлѓлаЛЋлалєла┬░лАРђџлАлі лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉла┬х.NrE   r}   u   лаЛюлаЛЋлалєлаЛЋла┬х лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉла┬хu4   лаЛЪлаЛЋла┬╗лАЛЊлАРђАла┬хлалЁлаЛЋ лалЁлаЛЋлалєлаЛЋла┬х лАлЃлаЛЋлаЛЋла┬▒лАРђ░ла┬хлалЁлаЛЉла┬х лаЛЋлАРђџ u"   , лаЛЋлАРђџлаЛћлАлѓлАРђ╣лАРђџлАлі лАРђАла┬░лАРђџ лАлЃ лалЁлаЛЉлаЛў?ZNOu┬ц   .
 лаРђЮла┬░лалЁлалЁлаЛЋлаЛќлаЛЋ лаЛЌлаЛЋла┬╗лАліла┬илаЛЋлалєла┬░лАРђџла┬хла┬╗лАлЈ лалЁла┬хлАРђџ лалє лалєла┬░лАРѓгла┬хлаЛў лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџ-ла┬╗лаЛЉлАлЃлАРђџла┬х.
 лаРђЮлаЛЋла┬▒ла┬░лалєлаЛЉлАРђџлАлі лалє лаЛћлаЛЋлалЁлАРђџла┬░лаЛћлАРђџлАРђ╣ лаЛЉ лаЛЋлАРђџлаЛћлАлѓлАРђ╣лАРђџлАлі лАРђАла┬░лАРђџ лАлЃ лалЁлаЛЉлаЛў?)rРђџ   лф	b64decodeлфMESSAGE_TEXTr   лфdecryptлф
ValueErrorлф	TypeErrorr'   rc   r   rРђА   r(   rРђъ   лфSENDERrW   лф
check_contactZquestionr   ZYesZNorY   лфprintrk   )r1   лфmessageZencrypted_messageZdecrypted_messageлфsenderr5   r5   r6   rЛњ   %  sX    	ЛЈЛЇ


ЛІЛІ

ЛІЛІ
ЛЈzClientMainWindow.messagec                 C   s   | j ┬а| ddлј | ┬алј  dS )uлг
        лалјла┬╗лаЛЋлАРђџ лаЛЋла┬▒лАлѓла┬░ла┬▒лаЛЋлАРђџлАРђАлаЛЉлаЛћ лаЛЌлаЛЋлАРђџла┬хлАлѓлаЛЉ лАлЃлаЛЋла┬хламЉлалЁлаЛЉлалЁла┬хлалЁлаЛЉлАлЈ лАлЃ лАлЃла┬хлАлѓлалєла┬хлАлѓлаЛЋлаЛў.
        лаРђЎлАРђ╣ламЉла┬░лАРђўлАРђџ лаЛЋлаЛћлалЁлаЛЋ лаЛЌлАлѓла┬хламЉлАЛЊлаЛЌлАлѓла┬хла┬ХламЉла┬хлалЁлаЛЉла┬х лаЛЉ ла┬ила┬░лалєла┬хлАлѓлАРѓгла┬░ла┬хлАРђџ лАлѓла┬░ла┬▒лаЛЋлАРђџлАЛЊ лаЛЌлАлѓлаЛЉла┬╗лаЛЋла┬Хла┬хлалЁлаЛЉлАлЈ.
        u   лалјла┬▒лаЛЋлаРёќ лАлЃлаЛЋла┬хламЉлаЛЉлалЁла┬хлалЁлаЛЉлАлЈu;   лаЛЪлаЛЋлАРђџла┬хлАлѓлАлЈлалЁлаЛЋ лАлЃлаЛЋла┬хламЉлаЛЉлалЁла┬хлалЁлаЛЉла┬х лАлЃ лАлЃла┬хлАлѓлалєла┬хлАлѓлаЛЋлаЛў. N)r'   rc   rl   r=   r5   r5   r6   лфconnection_lost^  s    ЛЇz ClientMainWindow.connection_lostc                 C   s>   | j r2| j┬а| j лјs2| j┬а| ddлј | ┬алј  d| _ | ┬алј  dS )u~
        лалјла┬╗лаЛЋлАРђџ лалєлАРђ╣лаЛЌлаЛЋла┬╗лалЁлАлЈлАлІлАРђ░лаЛЉлаРёќ лаЛЋла┬▒лалЁлаЛЋлалєла┬╗ла┬хлалЁлаЛЉла┬х ла┬▒ла┬░ла┬и ламЉла┬░лалЁлалЁлАРђ╣лАРђд лаЛЌлаЛЋ лаЛћлаЛЋлаЛўла┬░лалЁламЉла┬х лАлЃла┬хлАлѓлалєла┬хлАлѓла┬░.
        u   лалјлаЛЋлАРђАлАЛЊлалєлАлЃлАРђџлалєлАЛЊлАлІuQ   лаЛЎ лАлЃлаЛЋла┬Хла┬░ла┬╗ла┬хлалЁлаЛЉлАлІ лАлЃлаЛЋла┬▒ла┬хлАлЃла┬хламЉлалЁлаЛЉлаЛћ ла┬▒лАРђ╣ла┬╗ лАЛЊламЉла┬░ла┬╗лАРђўлалЁ лАлЃ лАлЃла┬хлАлѓлалєла┬хлАлѓла┬░.N)r(   r   лф
check_userr'   rc   r/   r.   r=   r5   r5   r6   лфsig_205j  s    ЛЈЛЇzClientMainWindow.sig_205c                 C   s.   |j ┬а| jлј |j┬а| jлј |j┬а| jлј dS )u^   лаЛџла┬хлАРђџлаЛЋламЉ лаЛЋла┬▒ла┬хлАлЃлаЛЌла┬хлАРђАлаЛЉлалєла┬░лАлІлАРђ░лаЛЉлаРёќ лАлЃлаЛЋла┬хламЉлаЛЉлалЁла┬хлалЁлаЛЉла┬х лАлЃлаЛЉлаЛќлалЁла┬░ла┬╗лаЛЋлалє лаЛЉ лАлЃла┬╗лаЛЋлАРђџлаЛЋлалє.N)лфnew_messager   rЛњ   rРђЎ   лфmessage_205rРђЮ   )r1   Z	trans_objr5   r5   r6   лфmake_connectiony  s    z ClientMainWindow.make_connection)лф__name__лф
__module__лф__qualname__лф__doc__r   r/   rW   r-   rY   r.   r#   rf   rk   r$   rx   r"   r   лфdictrЛњ   rРђЎ   rРђЮ   rРђћ   лф
__classcell__r5   r5   r3   r6   r      s(   -*
'
8

r   )"лфPyQt5.QtWidgetsr   r   r   r   r   ZPyQt5.QtGuir   r   r	   r
   ZPyQt5.QtCorer   r   r
   Z
Crypto.Cipherr   ZCrypto.PublicKeyr   ra   лфloggingrРђџ   Zclient.main_window_convr   Zclient.add_contactr   Zclient.del_contactr   лф
common.errorsr   лфcommon.variablesлф	getLoggerr]   r   r5   r5   r5   r6   лф<module>   s   
